<p>ç»™ä½ ä¸€ä¸ªÂ <code>m x n</code>Â çš„çŸ©é˜µÂ <code>mat</code>Â å’Œä¸€ä¸ªæ•´æ•° <code>k</code> ï¼Œè¯·ä½ è¿”å›ä¸€ä¸ªçŸ©é˜µÂ <code>answer</code>Â ï¼Œå…¶ä¸­æ¯ä¸ªÂ <code>answer[i][j]</code>Â æ˜¯æ‰€æœ‰æ»¡è¶³ä¸‹è¿°æ¡ä»¶çš„å…ƒç´ Â <code>mat[r][c]</code> çš„å’Œï¼šÂ </p>

<ul>
	<li><code>i - k <= r <= i + k, </code></li>
	<li><code>j - k <= c <= j + k</code> ä¸”</li>
	<li><code>(r, c)</code>Â åœ¨çŸ©é˜µå†…ã€‚</li>
</ul>

<p>Â </p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>mat = [[1,2,3],[4,5,6],[7,8,9]], k = 1
<strong>è¾“å‡ºï¼š</strong>[[12,21,16],[27,45,33],[24,39,28]]
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>mat = [[1,2,3],[4,5,6],[7,8,9]], k = 2
<strong>è¾“å‡ºï¼š</strong>[[45,45,45],[45,45,45],[45,45,45]]
</pre>

<p>Â </p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>m ==Â mat.length</code></li>
	<li><code>n ==Â mat[i].length</code></li>
	<li><code>1 <= m, n, k <= 100</code></li>
	<li><code>1 <= mat[i][j] <= 100</code></li>
</ul>
<details><summary><strong>Related Topics</strong></summary>æ•°ç»„ | çŸ©é˜µ | å‰ç¼€å’Œ</details><br>

<div>ğŸ‘ 144, ğŸ‘ 0</div>

<div id="labuladong"><hr>

**é€šçŸ¥ï¼š[æ•°æ®ç»“æ„ç²¾å“è¯¾ V1.8](https://aep.h5.xeknow.com/s/1XJHEO) æŒç»­æ›´æ–°ä¸­ã€‚**

<details><summary><strong>labuladong æ€è·¯</strong></summary>

## åŸºæœ¬æ€è·¯

è¿™é“é¢˜å¯ä»¥ç›´æ¥å¥—ç”¨å‰æ–‡ [å‰ç¼€å’Œæ•°ç»„æŠ€å·§](https://labuladong.github.io/article/fname.html?fname=å‰ç¼€å’ŒæŠ€å·§) ä¸­è®² [304. äºŒç»´åŒºåŸŸå’Œæ£€ç´¢](/problems/range-sum-query-2d-immutable) æ—¶å®ç°çš„ `NumMatrix` ç±»ï¼Œæ²¡ä»€ä¹ˆéš¾åº¦ã€‚ä¸»è¦æ³¨æ„ä¸‹é€šè¿‡ `min, max` å‡½æ•°ä¼˜é›…é¿å…ç´¢å¼•è¶Šç•Œçš„æŠ€å·§ï¼Œè¿™ä¸ªè¿˜æ˜¯è›®å¸¸ç”¨çš„ã€‚

**æ ‡ç­¾ï¼šå‰ç¼€å’Œï¼Œ[æ•°æ®ç»“æ„](https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxODQxMDM0Mw==&action=getalbum&album_id=1318892385270808576)ï¼Œ[æ•°ç»„](https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxODQxMDM0Mw==&action=getalbum&album_id=2120601117519675393)**

## è§£æ³•ä»£ç 

```java
class Solution {
    public int[][] matrixBlockSum(int[][] mat, int k) {
        int m = mat.length, n = mat[0].length;
        NumMatrix numMatrix = new NumMatrix(mat);
        int[][] res = new int[m][n];
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                // å·¦ä¸Šè§’çš„åæ ‡
                int x1 = Math.max(i - k, 0);
                int y1 = Math.max(j - k, 0);
                // å³ä¸‹è§’åæ ‡
                int x2 = Math.min(i + k, m - 1);
                int y2 = Math.min(j + k, n - 1);

                res[i][j] = numMatrix.sumRegion(x1, y1, x2, y2);
            }
        }
        return res;
    }
}

class NumMatrix {
    // å®šä¹‰ï¼špreSum[i][j] è®°å½• matrix ä¸­å­çŸ©é˜µ [0, 0, i-1, j-1] çš„å…ƒç´ å’Œ
    private int[][] preSum;

    public NumMatrix(int[][] matrix) {
        int m = matrix.length, n = matrix[0].length;
        if (m == 0 || n == 0) return;
        // æ„é€ å‰ç¼€å’ŒçŸ©é˜µ
        preSum = new int[m + 1][n + 1];
        for (int i = 1; i <= m; i++) {
            for (int j = 1; j <= n; j++) {
                // è®¡ç®—æ¯ä¸ªçŸ©é˜µ [0, 0, i, j] çš„å…ƒç´ å’Œ
                preSum[i][j] = preSum[i - 1][j] + preSum[i][j - 1] + matrix[i - 1][j - 1] - preSum[i - 1][j - 1];
            }
        }
    }

    // è®¡ç®—å­çŸ©é˜µ [x1, y1, x2, y2] çš„å…ƒç´ å’Œ
    public int sumRegion(int x1, int y1, int x2, int y2) {
        // ç›®æ ‡çŸ©é˜µä¹‹å’Œç”±å››ä¸ªç›¸é‚»çŸ©é˜µè¿ç®—è·å¾—
        return preSum[x2 + 1][y2 + 1] - preSum[x1][y2 + 1] - preSum[x2 + 1][y1] + preSum[x1][y1];
    }
}
```

</details>
</div>



